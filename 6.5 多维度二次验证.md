多维度二次验证{.text-center}
------------

&nbsp;

### 权威机构不再公正怎么办？

在签证换发绿卡环节，如果设立通密服务点的权威机构不再公正了怎么办？最优解是改换到由区块链，由公链中的挖矿节点提供服务。

不过，本系统仍有若干措施促使权威机构持续保持公正。其一，真身服务点能提供证据事后验证换发的绿卡有没作弊；其二，借助其它沟通渠道，从侧面验证活跃中的绿卡没有滥发。这些属于多维度二次验证的范畴，能起到事后监督的作用。

&nbsp;

### 验根码验证

用户用签证换发绿卡时，会先向真身服务点申请一个隐身份护照，授权目标的 child1 作为参数一起提交，然后服务点为该用户随机生成一个近期未用的 child2 值，用 `alt/0/0/child1/child2` 推导一个隐身份，包装成护照格式返回给用户。

隐护照中的验根码 rootcode 是一种简便的同属关系证明，其值与隐身份的父账号，也就是签证中的被授权目标账号，以及衍生序号 child2 相关。当应用网站想验证用户登录的绿卡是否伪造时，可以向真身服务点发请求，查询近期颁发的隐护照中与当前绿卡属主对应的那个验根码。如果验根码与当前绿卡中记录的 rootcode 值匹配，就大概率证明这份绿卡没有伪造。

这里，我们要区分一种情况，用户将自身账号授权给许多人使用是合法的，不算滥用，应用网站防止用户过多转授权，只需在登录环节增加条件限制即可，比方限制与同一资源关联的多个身份同时登录。但如果遇到未授权也能获得可用绿卡，则属安全事故，绿卡被伪造了，本系统要重点防范这种事故发生。

&nbsp;

### 完全验证绿卡与签证的同属关系

上述验根码验证只是大概率验证绿卡未伪造，并非完全验证。完全验证还需真身服务点提供推算 rootcode 的所有传入参数，即：被授权对象的公钥，及其子级（绿卡属主）的相对路径 child2。

然后应用网站用此公钥查找已颁发签证中是否有匹配项，若有，再用公钥与 child2 推导一遍 rootcode，将其结果与被查用户所持绿卡中的 rootcode 作比较，看看是否一致，如果一致就完全验证了绿卡与找出的签证是同属的。因为有了泛身份公钥，置其 chaincode 为空，应用网站也能自行推导其下 child2 相对路径的隐身份账号。

不过，这样的完全验证在一定程度上侵害了个人隐私，它让签证中授权对象与绿卡身份关联起来了。所以，真身服务点必须非常有限的提供完全同属验证服务。

如果改用公链中的节点颁发绿卡，隐身份就不必由真身服务点生成了，事后同属验证不依赖验根码匹配分析，也不依赖通过公布 rootcode 推导进行完全验证，它另设机制保障绿卡不被伪造。
